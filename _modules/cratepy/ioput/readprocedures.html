<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cratepy.ioput.readprocedures &mdash; CRATE 1.0.4 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/readthedocs-custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            CRATE
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/getting_started/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/getting_started/run_benchmark.html">Run a benchmark</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basic usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/basic_usage/general_workflow.html">General workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/basic_usage/step1_material_model.html">Step 1: Material model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/basic_usage/step2_input_data.html">Step 2: Input data file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/basic_usage/step3_simulation.html">Step 3: Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/basic_usage/step4_post_processing.html">Step 4: Post-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/basic_usage/available_features.html">Available features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Validation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/validation/benchmarks.html">Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/advanced_usage/customization.html">Customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/advanced_usage/interface_dns_solver.html">Interface: DNS solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/advanced_usage/interface_clustering_feature.html">Interface: Clustering feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/advanced_usage/interface_clustering_algorithm.html">Interface: Clustering algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/advanced_usage/interface_constitutive_model.html">Interface: Constitutive model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/reference/index.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../_autosummary/cratepy.html">Code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">License</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">BSD 3-Clause License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">CRATE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">cratepy.ioput.readprocedures</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for cratepy.ioput.readprocedures</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Input data file reading and checking procedures.</span>

<span class="sd">This module includes a set of general and specific functions to read and</span>
<span class="sd">process data from the input data file. These functions also perform some checks</span>
<span class="sd">on the input data to avoid downstream execution errors.</span>

<span class="sd">Functions</span>
<span class="sd">---------</span>
<span class="sd">searchkeywordline</span>
<span class="sd">    Search mandatory keyword in data file and get corresponding line number.</span>
<span class="sd">searchoptkeywordline</span>
<span class="sd">    Search optional keyword in data file and get corresponding line number.</span>
<span class="sd">readtypeAkeyword</span>
<span class="sd">    Read keyword of specification type A.</span>
<span class="sd">readtypeBkeyword</span>
<span class="sd">    Read keyword of specification type B.</span>
<span class="sd">read_material_properties</span>
<span class="sd">    Read material phases data and properties.</span>
<span class="sd">read_macroscale_loading</span>
<span class="sd">    Read macroscale loading constraints.</span>
<span class="sd">read_mac_load_increm</span>
<span class="sd">    Read macroscale loading incrementation.</span>
<span class="sd">decode_increm_spec</span>
<span class="sd">    Decode macroscale loading increment specification.</span>
<span class="sd">read_phase_clustering</span>
<span class="sd">    Read (base) number of clusters associated with each material phase.</span>
<span class="sd">read_clustering_scheme</span>
<span class="sd">    Read material phase&#39;s prescribed clustering scheme.</span>
<span class="sd">check_clustering_scheme</span>
<span class="sd">    Check material phase&#39;s prescribed clustering scheme.</span>
<span class="sd">read_adaptivity_frequency</span>
<span class="sd">    Read clustering adaptivity frequency.</span>
<span class="sd">read_rewind_state_parameters</span>
<span class="sd">    Read the solution rewind state criterion parameters.</span>
<span class="sd">read_rewinding_criterion_parameters</span>
<span class="sd">    Read the solution rewinding criterion parameters.</span>
<span class="sd">read_discretization_file_path</span>
<span class="sd">    Read spatial discretization file path.</span>
<span class="sd">read_rve_dimensions</span>
<span class="sd">    Read RVE dimensions (size length along each spatial dimension).</span>
<span class="sd">read_self_consistent_scheme</span>
<span class="sd">    Read self-consistent scheme and associated parameters.</span>
<span class="sd">read_vtk_options</span>
<span class="sd">    Read VTK output options.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1">#                                                                       Modules</span>
<span class="c1"># =============================================================================</span>
<span class="c1"># Standard</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">linecache</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="c1"># Third-party</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># Local</span>
<span class="kn">import</span> <span class="nn">ioput.info</span> <span class="k">as</span> <span class="nn">info</span>
<span class="kn">import</span> <span class="nn">ioput.ioutilities</span> <span class="k">as</span> <span class="nn">ioutil</span>
<span class="kn">from</span> <span class="nn">clustering.crve</span> <span class="kn">import</span> <span class="n">CRVE</span>
<span class="kn">from</span> <span class="nn">clustering.clusteringphase</span> <span class="kn">import</span> <span class="n">SCRMP</span>
<span class="kn">from</span> <span class="nn">clustering.adaptivity.crve_adaptivity</span> <span class="kn">import</span> <span class="n">AdaptivityManager</span>
<span class="kn">from</span> <span class="nn">online.loading.macloadincrem</span> <span class="kn">import</span> <span class="n">RewindManager</span>
<span class="kn">from</span> <span class="nn">material.materialmodeling</span> <span class="kn">import</span> <span class="n">get_available_material_models</span>
<span class="kn">from</span> <span class="nn">material.models.elastic</span> <span class="kn">import</span> <span class="n">Elastic</span>
<span class="kn">from</span> <span class="nn">material.models.von_mises</span> <span class="kn">import</span> <span class="n">VonMises</span>
<span class="kn">from</span> <span class="nn">material.models.stvenant_kirchhoff</span> <span class="kn">import</span> <span class="n">StVenantKirchhoff</span>
<span class="kn">from</span> <span class="nn">online.crom.asca</span> <span class="kn">import</span> <span class="n">ElasticReferenceMaterial</span>
<span class="c1">#</span>
<span class="c1">#                                                          Authorship &amp; Credits</span>
<span class="c1"># =============================================================================</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;Bernardo Ferreira (bernardo_ferreira@brown.edu)&#39;</span>
<span class="n">__credits__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Bernardo Ferreira&#39;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">__status__</span> <span class="o">=</span> <span class="s1">&#39;Stable&#39;</span>
<span class="c1"># =============================================================================</span>
<span class="c1">#</span>
<span class="c1"># =============================================================================</span>
<span class="c1">#</span>
<span class="c1">#                                                               Search keywords</span>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="searchkeywordline"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.searchkeywordline.html#cratepy.ioput.readprocedures.searchkeywordline">[docs]</a><span class="k">def</span> <span class="nf">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Search mandatory keyword in data file and get corresponding line number.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    keyword : str</span>
<span class="sd">        Keyword.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    line_number : int</span>
<span class="sd">        Number of data file line where the keyword is first found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">line_number</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">line_number</span> <span class="o">=</span> <span class="n">line_number</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;#&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">line_number</span>
    <span class="c1"># Keyword not found</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing keyword&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - has not been found in the input &#39;</span> \
        <span class="o">+</span> <span class="s1">&#39;data file.&#39;</span>
    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="searchoptkeywordline"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.searchoptkeywordline.html#cratepy.ioput.readprocedures.searchoptkeywordline">[docs]</a><span class="k">def</span> <span class="nf">searchoptkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Search optional keyword in data file and get corresponding line number.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    keyword : str</span>
<span class="sd">        Keyword.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    is_found : bool</span>
<span class="sd">        `True` if keyword is found in data file, `False` otherwise.</span>
<span class="sd">    line_number : int</span>
<span class="sd">        Number of data file line where the keyword is first found. Set to 0 by</span>
<span class="sd">        default if keyword is not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_found</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">line_number</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">line_number</span> <span class="o">=</span> <span class="n">line_number</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;#&#39;</span><span class="p">:</span>
            <span class="n">is_found</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">is_found</span><span class="p">,</span> <span class="n">line_number</span>
    <span class="k">return</span> <span class="n">is_found</span><span class="p">,</span> <span class="n">line_number</span></div>
<span class="c1">#</span>
<span class="c1">#                                                           Parameter formatter</span>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="get_formatted_parameter"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.get_formatted_parameter.html#cratepy.ioput.readprocedures.get_formatted_parameter">[docs]</a><span class="k">def</span> <span class="nf">get_formatted_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">etype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get string parameter converted to appropriate type.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameter : str</span>
<span class="sd">        Parameter name.</span>
<span class="sd">    x : str</span>
<span class="sd">        Parameter specification.</span>
<span class="sd">    etype : {int, float, str, bool}, default=None</span>
<span class="sd">        Parameter expected type.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    y : {&#39;int&#39;, &#39;float&#39;, &#39;str&#39;, &#39;bool&#39;}</span>
<span class="sd">        Parameter value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get parameter specification type and associated value</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)):</span>
            <span class="n">stype_name</span> <span class="o">=</span> <span class="s1">&#39;int&#39;</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stype_name</span> <span class="o">=</span> <span class="s1">&#39;float&#39;</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;on&#39;</span><span class="p">:</span>
            <span class="n">stype_name</span> <span class="o">=</span> <span class="s1">&#39;bool&#39;</span>
            <span class="n">y</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;off&#39;</span><span class="p">:</span>
            <span class="n">stype_name</span> <span class="o">=</span> <span class="s1">&#39;bool&#39;</span>
            <span class="n">y</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stype_name</span> <span class="o">=</span> <span class="s1">&#39;str&#39;</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check if specification type agrees with expected type</span>
    <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">stype_name</span> <span class="o">!=</span> <span class="n">etype</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The parameter </span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
                            <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1"> hasn</span><span class="se">\&#39;</span><span class="s1">t been properly specified: expected &#39;</span>
                            <span class="o">+</span> <span class="n">etype</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39; but found &#39;</span> <span class="o">+</span> <span class="n">stype_name</span>
                            <span class="o">+</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return</span>
    <span class="k">return</span> <span class="n">y</span></div>
<span class="c1">#</span>
<span class="c1">#                                                              General keywords</span>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="readtypeAkeyword"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.readtypeAkeyword.html#cratepy.ioput.readprocedures.readtypeAkeyword">[docs]</a><span class="k">def</span> <span class="nf">readtypeAkeyword</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">max_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read keyword of specification type A.</span>

<span class="sd">    The keyword specification of type A is associated with a positive</span>
<span class="sd">    integer-valued keyword and has the following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       &lt; keyword &gt; &lt; int &gt;</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword : str</span>
<span class="sd">        Keyword.</span>
<span class="sd">    max_val : int</span>
<span class="sd">        Maximum value of keyword positive integer value.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    keyword_value : int</span>
<span class="sd">        Keyword value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_val</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_val</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">max_val</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="readtypeBkeyword"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.readtypeBkeyword.html#cratepy.ioput.readprocedures.readtypeBkeyword">[docs]</a><span class="k">def</span> <span class="nf">readtypeBkeyword</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read keyword of specification type B.</span>

<span class="sd">    The keyword specification of type B is associated with a positive</span>
<span class="sd">    float-valued keyword and has the following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       &lt; keyword &gt;</span>
<span class="sd">       &lt; float &gt;</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword : str</span>
<span class="sd">        Keyword.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    keyword_value : float</span>
<span class="sd">        Keyword value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_line_number</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checknumber</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>
<span class="c1">#</span>
<span class="c1">#                                                             Specific keywords</span>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_material_properties"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_material_properties.html#cratepy.ioput.readprocedures.read_material_properties">[docs]</a><span class="k">def</span> <span class="nf">read_material_properties</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read material phases data and properties.</span>

<span class="sd">    The specification of the data associated with the material phases has the</span>
<span class="sd">    following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        Material_Phases &lt; n_material_phases &gt;</span>
<span class="sd">        &lt; phase_id &gt; &lt; model_name &gt; &lt; n_prop_copt &gt; [ &lt; model_source &gt; ]</span>
<span class="sd">        &lt; property_1_name &gt; &lt; value &gt;</span>
<span class="sd">        &lt; property_2_name &gt; &lt; value &gt;</span>
<span class="sd">        &lt; constitutive_option_1_name &gt; &lt; option &gt; [ &lt; n_coproperties &gt; ]</span>
<span class="sd">            &lt; coproperty_1_name &gt; &lt; value &gt;</span>
<span class="sd">            &lt; coproperty_2_name &gt; &lt; value &gt;</span>
<span class="sd">        &lt; phase_id &gt; &lt; model_name &gt; &lt; n_prop_copt &gt; [ &lt; model_source &gt; ]</span>
<span class="sd">        &lt; property1_name &gt; &lt; value &gt;</span>
<span class="sd">        &lt; constitutive_option_1_name &gt; &lt; option &gt; [ &lt; n_coproperties &gt; ]</span>
<span class="sd">            &lt; coproperty_1_name &gt; &lt; value &gt;</span>
<span class="sd">            &lt; coproperty_2_name &gt; &lt; value &gt;</span>
<span class="sd">        &lt; property2_name &gt; &lt; value &gt;</span>
<span class="sd">        ...</span>

<span class="sd">    where `n_material_phases` (int) is the number of material phases,</span>
<span class="sd">    `phase_id` (int) is the material identifier , `model_name` (str) is the</span>
<span class="sd">    constitutive model name, `n_prop_copt` (int) is the total number of</span>
<span class="sd">    constitutive properties and options, `model_source` (int, optional) is the</span>
<span class="sd">    constitutive model source, `property_X_name` (str) is the constitutive</span>
<span class="sd">    property name, `constitutive_option_X_name` is the constitutive option</span>
<span class="sd">    name, `n_coproperties` is the number of properties associated with the</span>
<span class="sd">    constitutive option, and `coproperty_X_name` is the constitutive option</span>
<span class="sd">    property name.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword : str</span>
<span class="sd">        Keyword.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    n_material_phases : int</span>
<span class="sd">        Number of material phases.</span>
<span class="sd">    material_phases_data : dict</span>
<span class="sd">        Material phase data (item, dict) associated with each material phase</span>
<span class="sd">        (key, str).</span>
<span class="sd">    material_phases_properties : dict</span>
<span class="sd">        Constitutive model material properties (item, dict) associated with</span>
<span class="sd">        each material phase (key, str).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Search keyword</span>
    <span class="n">keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing number of material phases&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing number of material phases.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid number of material phases&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid number of material phases.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set number of material phases</span>
    <span class="n">n_material_phases</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Initialize material phases properties and constitutive models</span>
    <span class="c1"># dictionaries</span>
    <span class="n">material_phases_properties</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">material_phases_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Loop over material phases</span>
    <span class="n">line_number</span> <span class="o">=</span> <span class="n">keyword_line_number</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_material_phases</span><span class="p">):</span>
        <span class="c1"># Read material phase header</span>
        <span class="n">phase_header</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">phase_header</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing material phase header&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing specification of a material phase header.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">phase_header</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing material phase header&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing specification of a material phase header.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">phase_header</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid material phase header&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid specification of a material phase header.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">phase_header</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">material_phases_properties</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Duplicated material phase header&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Duplicated specification of a material phase &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;header.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="c1"># Set material phase</span>
        <span class="n">mat_phase</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">phase_header</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="n">material_phases_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Get material phase constitutive model source identifier</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">phase_header</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># If the material phase constitutive model source has not been</span>
            <span class="c1"># specified, then assume CRATE by default</span>
            <span class="n">model_source_id</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">phase_header</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="c1"># Set constitutive model source</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">phase_header</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid constitutive model source&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span>\
                    <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid constitutive model source of &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">model_source_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">phase_header</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="c1"># Set material phase constitutive model source</span>
        <span class="k">if</span> <span class="n">model_source_id</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model_source</span> <span class="o">=</span> <span class="s1">&#39;crate&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Unknown constitutive model source&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span>\
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown constitutive model source of &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
        <span class="c1"># Assemble material phase constitutive model source</span>
        <span class="n">material_phases_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_source</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Get available material constitutive models</span>
        <span class="n">available_mat_models</span> <span class="o">=</span> <span class="n">get_available_material_models</span><span class="p">(</span><span class="n">model_source</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set material phase constitutive model keyword</span>
        <span class="k">if</span> <span class="n">phase_header</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">available_mat_models</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Unknown material constitutive model&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span>\
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown material constitutive model of &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                             <span class="n">phase_header</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model_keyword</span> <span class="o">=</span> <span class="n">phase_header</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">material_phases_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="s1">&#39;keyword&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_keyword</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Get material constitutive model constitutive options and material</span>
        <span class="c1"># properties</span>
        <span class="k">if</span> <span class="n">model_source</span> <span class="o">==</span> <span class="s1">&#39;crate&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">model_keyword</span> <span class="o">==</span> <span class="s1">&#39;elastic&#39;</span><span class="p">:</span>
                <span class="n">req_properties</span><span class="p">,</span> <span class="n">req_constitutive_options</span> <span class="o">=</span> \
                    <span class="n">Elastic</span><span class="o">.</span><span class="n">get_required_properties</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">model_keyword</span> <span class="o">==</span> <span class="s1">&#39;von_mises&#39;</span><span class="p">:</span>
                <span class="n">req_properties</span><span class="p">,</span> <span class="n">req_constitutive_options</span> <span class="o">=</span> \
                    <span class="n">VonMises</span><span class="o">.</span><span class="n">get_required_properties</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">model_keyword</span> <span class="o">==</span> <span class="s1">&#39;stvenant_kirchhoff&#39;</span><span class="p">:</span>
                <span class="n">req_properties</span><span class="p">,</span> <span class="n">req_constitutive_options</span> <span class="o">=</span> \
                    <span class="n">StVenantKirchhoff</span><span class="o">.</span><span class="n">get_required_properties</span><span class="p">()</span>
        <span class="c1"># Set number of constitutive options and material properties</span>
        <span class="n">n_prop_copt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">req_properties</span><span class="p">)</span> \
            <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">req_constitutive_options</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">phase_header</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid number of material properties&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span>\
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid number of material properties and &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;constitutive options of material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">phase_header</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">!=</span> <span class="n">n_prop_copt</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Wrong number of material properties&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span>\
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Wrong number of material properties and &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;constitutive options of material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Update line number</span>
        <span class="n">line_number</span> <span class="o">=</span> <span class="n">line_number</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set constitutive options and all material properties</span>
        <span class="n">material_phases_properties</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Loop over constitutive options and material properties</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_prop_copt</span><span class="p">):</span>
            <span class="n">property_header_line</span> <span class="o">=</span> <span class="n">line_number</span>
            <span class="n">property_line</span> <span class="o">=</span> \
                <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">property_header_line</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">property_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid material property or constitutive option&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span>\
                    <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid material property or constitutive &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;option of material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkvalidname</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid material property or constitutive option&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span>\
                    <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid material property or constitutive &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;option of material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">property_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">req_properties</span> <span class="ow">and</span> \
                    <span class="n">property_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">req_constitutive_options</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid material property or constitutive option&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span>\
                    <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid material property or constitutive &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;option of material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">property_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> \
                    <span class="n">material_phases_properties</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Duplicated material property or constitutive option&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span>\
                    <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Duplicated material property or constitutive &#39;</span>\
                    <span class="o">+</span> <span class="s1">&#39;option of material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Read material property or constitutive option (and associated</span>
            <span class="c1"># material properties)</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="n">req_constitutive_options</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># Check if constitutive option specification is available</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> \
                        <span class="n">req_constitutive_options</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">0</span><span class="p">])]:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Unknown constitutive option&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown constitutive option of material &#39;</span>\
                        <span class="o">+</span> <span class="s1">&#39;phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                                     <span class="n">mat_phase</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">constitutive_option</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="c1"># Assemble constitutive option specification</span>
                <span class="n">material_phases_properties</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="n">constitutive_option</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Read constitutive option number of associated properties</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">property_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid number of properties of &#39;</span> \
                            <span class="o">+</span> <span class="s1">&#39;constitutive option&#39;</span>
                        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                            <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid number of constitutive &#39;</span> \
                            <span class="o">+</span> <span class="s1">&#39;options of material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                                         <span class="n">mat_phase</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">n_coproperties</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">property_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">n_coproperties</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid constitutive option&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid constitutive option of material &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                                     <span class="n">mat_phase</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;isotropic_hardening&#39;</span> <span class="ow">and</span> \
                        <span class="n">constitutive_option</span> <span class="o">==</span> <span class="s1">&#39;piecewise_linear&#39;</span><span class="p">:</span>
                    <span class="c1"># Initialize hardening points</span>
                    <span class="n">hardening_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_coproperties</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
                    <span class="c1"># Read hardening points</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_coproperties</span><span class="p">):</span>
                        <span class="c1"># Read hardening point line</span>
                        <span class="n">hardening_point_line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span>
                            <span class="n">file_path</span><span class="p">,</span> <span class="n">property_header_line</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">hardening_point_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid hardening point&#39;</span>
                            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The specification of a strain &#39;</span> \
                                <span class="o">+</span> <span class="s1">&#39;hardening point of material phase </span><span class="si">{}</span><span class="s1"> in &#39;</span> \
                                <span class="o">+</span> <span class="s1">&#39;the input data&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;file is invalid.&#39;</span>
                            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span>
                                             <span class="n">mat_phase</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">hardening_point_line</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
                            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid hardening point&#39;</span>
                            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The specification of a strain &#39;</span> \
                                <span class="o">+</span> <span class="s1">&#39;hardening point of material phase </span><span class="si">{}</span><span class="s1"> in &#39;</span> \
                                <span class="o">+</span> <span class="s1">&#39;the input data&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;file is invalid.&#39;</span>
                            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span>
                                             <span class="n">mat_phase</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checknumber</span><span class="p">(</span><span class="n">hardening_point_line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> \
                                <span class="ow">or</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checknumber</span><span class="p">(</span>
                                    <span class="n">hardening_point_line</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid hardening point&#39;</span>
                            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The specification of a strain &#39;</span> \
                                <span class="o">+</span> <span class="s1">&#39;hardening point of material phase </span><span class="si">{}</span><span class="s1"> in &#39;</span> \
                                <span class="o">+</span> <span class="s1">&#39;the input data&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;file is invalid.&#39;</span>
                            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span>
                                             <span class="n">mat_phase</span><span class="p">)</span>
                        <span class="n">hardening_points</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">hardening_point_line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">hardening_points</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">hardening_point_line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="c1"># Assemble constitutive parameter associated property</span>
                    <span class="n">material_phases_properties</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span>
                        <span class="s1">&#39;hardening_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hardening_points</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Read constitutive option associated properties</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_coproperties</span><span class="p">):</span>
                        <span class="c1"># Read constitutive option line</span>
                        <span class="n">coproperty_line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span>
                            <span class="n">file_path</span><span class="p">,</span> <span class="n">property_header_line</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coproperty_line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid constitutive option&#39;</span>
                            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not &#39;</span> \
                                <span class="o">+</span> <span class="s1">&#39;properly defined in the input data file.&#39;</span> \
                                <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid constitutive option of &#39;</span> \
                                <span class="o">+</span> <span class="s1">&#39;material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span>
                                             <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
                        <span class="c1"># Get property name</span>
                        <span class="n">prop_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">coproperty_line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="c1"># Get property value</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coproperty_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="c1"># Single value</span>
                            <span class="n">prop_value</span> <span class="o">=</span> <span class="n">get_formatted_parameter</span><span class="p">(</span>
                                <span class="n">coproperty_line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coproperty_line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Multiple values stored as tuple</span>
                            <span class="n">prop_value</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                                <span class="p">(</span><span class="n">get_formatted_parameter</span><span class="p">(</span><span class="n">coproperty_line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                         <span class="n">coproperty_line</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
                                 <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coproperty_line</span><span class="p">))))</span>
                        <span class="c1"># Assemble constitutive parameter associated property</span>
                        <span class="n">material_phases_properties</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="n">prop_value</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Update line number</span>
                <span class="n">line_number</span> <span class="o">=</span> <span class="n">line_number</span> <span class="o">+</span> <span class="n">n_coproperties</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">property_line</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid material property&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid material property of material &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                                     <span class="n">mat_phase</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checknumber</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid material property&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid material property of material &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                                     <span class="n">mat_phase</span><span class="p">)</span>
                <span class="n">prop_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">prop_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">property_line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">material_phases_properties</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop_value</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Update line number</span>
            <span class="n">line_number</span> <span class="o">=</span> <span class="n">line_number</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">n_material_phases</span><span class="p">,</span> <span class="n">material_phases_data</span><span class="p">,</span> <span class="n">material_phases_properties</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_macroscale_loading"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_macroscale_loading.html#cratepy.ioput.readprocedures.read_macroscale_loading">[docs]</a><span class="k">def</span> <span class="nf">read_macroscale_loading</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">mac_load_type</span><span class="p">,</span> <span class="n">strain_formulation</span><span class="p">,</span>
                            <span class="n">n_dim</span><span class="p">,</span> <span class="n">comp_order_nsym</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read macroscale loading constraints.</span>

<span class="sd">    The storage of the macroscale strain/stress tensors is performed according</span>
<span class="sd">    to the problem type nonsymmetric component order.</span>

<span class="sd">    The specification of the data associated with the macroscale loading</span>
<span class="sd">    constraints has the following input data file syntax:</span>

<span class="sd">    **2D Problem:**</span>

<span class="sd">    *Macroscale strain constraint:*</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Macroscale_Strain [&lt; n_load_subpaths &gt;]</span>
<span class="sd">       &lt; component_name_11 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_21 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_12 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_22 &gt; &lt; float &gt; &lt; float &gt;  ...</span>

<span class="sd">    where `n_load_subpaths` is the number of loading subpaths (defaults to 1),</span>
<span class="sd">    each associated with a given column. Irrespective of the name given to each</span>
<span class="sd">    component, it is assumed that all the components of the macroscale strain</span>
<span class="sd">    tensor (assumed nonsymmetric) are specified in columnwise order.</span>

<span class="sd">    *Macroscale stress constraint:*</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Macroscale_Stress [&lt; n_load_subpaths &gt;]</span>
<span class="sd">       &lt; component_name_11 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_21 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_12 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_22 &gt; &lt; float &gt; &lt; float &gt;  ...</span>

<span class="sd">    where `n_load_subpaths` is the number of loading subpaths (defaults to 1),</span>
<span class="sd">    each associated with a given column. Irrespective of the name given to each</span>
<span class="sd">    component, it is assumed that all the components of the macroscale stress</span>
<span class="sd">    tensor (assumed nonsymmetric) are specified in columnwise order.</span>

<span class="sd">    *Macroscale strain and stress constraint:*</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Macroscale_Strain [&lt; n_load_subpaths &gt;]</span>
<span class="sd">       &lt; component_name_11 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_21 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_12 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_22 &gt; &lt; float &gt; &lt; float &gt;  ...</span>

<span class="sd">       Macroscale_Stress &lt; n_load_subpaths &gt;</span>
<span class="sd">       &lt; component_name_11 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_21 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_12 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_22 &gt; &lt; float &gt; &lt; float &gt;  ...</span>

<span class="sd">       Mixed_Prescription_Index</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>

<span class="sd">    where `n_load_subpaths` is the number of loading subpaths (defaults to 1),</span>
<span class="sd">    each associated with a given column. The corresponding nature of each</span>
<span class="sd">    strain (0) or stress (1) component is specified accordingly under the</span>
<span class="sd">    `Mixed_Prescription_Index` keyword. Irrespective of the name given to each</span>
<span class="sd">    component, it is assumed that all the components of the macroscale strain</span>
<span class="sd">    and stress tensors (assumed nonsymmetric) are specified in columnwise</span>
<span class="sd">    order. Components not enforced through the mixed loading prescription are</span>
<span class="sd">    ignored.</span>

<span class="sd">    ----</span>

<span class="sd">    **3D Problem:**</span>

<span class="sd">    *Macroscale strain constraint:*</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Macroscale_Strain [&lt; n_load_subpaths &gt;]</span>
<span class="sd">       &lt; component_name_11 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_21 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_31 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_12 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_22 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_32 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_13 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_23 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_33 &gt; &lt; float &gt; &lt; float &gt;  ...</span>

<span class="sd">    where `n_load_subpaths` is the number of loading subpaths (defaults to 1),</span>
<span class="sd">    each associated with a given column. Irrespective of the name given to each</span>
<span class="sd">    component, it is assumed that all the components of the macroscale strain</span>
<span class="sd">    tensor (assumed nonsymmetric) are specified in columnwise order.</span>

<span class="sd">    *Macroscale stress constraint:*</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Macroscale_Stress [&lt; n_load_subpaths &gt;]</span>
<span class="sd">       &lt; component_name_11 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_21 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_31 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_12 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_22 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_32 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_13 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_23 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_33 &gt; &lt; float &gt; &lt; float &gt;  ...</span>

<span class="sd">    where `n_load_subpaths` is the number of loading subpaths (defaults to 1),</span>
<span class="sd">    each associated with a given column. Irrespective of the name given to each</span>
<span class="sd">    component, it is assumed that all the components of the macroscale stress</span>
<span class="sd">    tensor (assumed nonsymmetric) are specified in columnwise order.</span>

<span class="sd">    *Macroscale strain and stress constraint:*</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Macroscale_Strain [&lt; n_load_subpaths &gt;]</span>
<span class="sd">       &lt; component_name_11 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_21 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_31 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_12 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_22 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_32 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_13 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_23 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_33 &gt; &lt; float &gt; &lt; float &gt;  ...</span>

<span class="sd">       Macroscale_Stress [&lt; n_load_subpaths &gt;]</span>
<span class="sd">       &lt; component_name_11 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_21 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_31 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_12 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_22 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_32 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_13 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_23 &gt; &lt; float &gt; &lt; float &gt;  ...</span>
<span class="sd">       &lt; component_name_33 &gt; &lt; float &gt; &lt; float &gt;  ...</span>

<span class="sd">       Mixed_Prescription_Index</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>
<span class="sd">       &lt; 0 or 1 &gt; &lt; 0 or 1 &gt;  ...</span>

<span class="sd">    where `n_load_subpaths` is the number of loading subpaths (defaults to 1),</span>
<span class="sd">    each associated with a given column. The corresponding nature of each</span>
<span class="sd">    strain (0) or stress (1) component is specified accordingly under the</span>
<span class="sd">    `Mixed_Prescription_Index` keyword. Irrespective of the name given to each</span>
<span class="sd">    component, it is assumed that all the components of the macroscale strain</span>
<span class="sd">    and stress tensors (assumed nonsymmetric) are specified in columnwise</span>
<span class="sd">    order. Components not enforced through the mixed loading prescription are</span>
<span class="sd">    ignored.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    mac_load_type : {1, 2, 3}</span>
<span class="sd">        Macroscale loading type:</span>

<span class="sd">        * 1 : Macroscale strain constraint</span>
<span class="sd">        * 2 : Macroscale stress constraint</span>
<span class="sd">        * 3 : Macroscale strain and stress constraint</span>
<span class="sd">    strain_formulation: {&#39;infinitesimal&#39;, &#39;finite&#39;}</span>
<span class="sd">        Problem strain formulation.</span>
<span class="sd">    n_dim : int</span>
<span class="sd">        Problem number of spatial dimensions.</span>
<span class="sd">    comp_order_nsym : list[str]</span>
<span class="sd">        Strain/Stress components nonsymmetric order.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mac_load : dict</span>
<span class="sd">        For each loading nature type (key, {&#39;strain&#39;, &#39;stress&#39;}), stores</span>
<span class="sd">        the loading constraints for each loading subpath in a</span>
<span class="sd">        numpy.ndarray (2d), where the i-th row is associated with the i-th</span>
<span class="sd">        strain/stress component and the j-th column is associated with the</span>
<span class="sd">        j-th loading subpath.</span>
<span class="sd">    mac_load_presctype : numpy.ndarray (2d)</span>
<span class="sd">        Loading nature type ({&#39;strain&#39;, &#39;stress&#39;}) associated with each</span>
<span class="sd">        loading constraint (ndarray of shape (n_comps, n_load_subpaths)),</span>
<span class="sd">        where the i-th row is associated with the i-th strain/stress</span>
<span class="sd">        component and the j-th column is associated with the j-th loading</span>
<span class="sd">        subpath.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set macroscale loading keywords according to loading type</span>
    <span class="k">if</span> <span class="n">mac_load_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">loading_keywords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Macroscale_Strain&#39;</span><span class="p">:</span> <span class="s1">&#39;strain&#39;</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">mac_load_type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">loading_keywords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Macroscale_Stress&#39;</span><span class="p">:</span> <span class="s1">&#39;stress&#39;</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">mac_load_type</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">loading_keywords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Macroscale_Strain&#39;</span><span class="p">:</span> <span class="s1">&#39;strain&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Macroscale_Stress&#39;</span><span class="p">:</span> <span class="s1">&#39;stress&#39;</span><span class="p">}</span>
        <span class="n">presc_keyword</span> <span class="o">=</span> <span class="s1">&#39;Mixed_Prescription_Index&#39;</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Initialize macroscale loading dictionary</span>
    <span class="n">mac_load</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;strain&#39;</span><span class="p">,</span> <span class="s1">&#39;stress&#39;</span><span class="p">]}</span>
    <span class="c1"># Initialize number of macroscale loading subpaths dictionary</span>
    <span class="n">n_load_subpaths</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;strain&#39;</span><span class="p">,</span> <span class="s1">&#39;stress&#39;</span><span class="p">]}</span>
    <span class="c1"># Loop over macroscale loading keywords</span>
    <span class="k">for</span> <span class="n">load_key</span> <span class="ow">in</span> <span class="n">loading_keywords</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="c1"># Get load nature type</span>
        <span class="n">ltype</span> <span class="o">=</span> <span class="n">loading_keywords</span><span class="p">[</span><span class="n">load_key</span><span class="p">]</span>
        <span class="c1"># Get macroscale loading keyword line number</span>
        <span class="n">load_keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">load_key</span><span class="p">)</span>
        <span class="c1"># Check number of loading subpaths</span>
        <span class="n">keyword_line</span> <span class="o">=</span> \
            <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">load_keyword_line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keyword_line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid number of loading subpaths&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The specification of the number of macroscale &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;loading subpaths in the input data file &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;is invalid.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">keyword_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">keyword_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">n_load_subpaths</span><span class="p">[</span><span class="n">ltype</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keyword_line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid number of loading subpaths&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The specification of the number of macroscale &#39;</span>\
                    <span class="o">+</span> <span class="s1">&#39;loading subpaths in the input data file &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;is invalid.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_load_subpaths</span><span class="p">[</span><span class="n">ltype</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># Initialize macroscale loading array</span>
        <span class="n">mac_load</span><span class="p">[</span><span class="n">ltype</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n_dim</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_load_subpaths</span><span class="p">[</span><span class="n">ltype</span><span class="p">]),</span> <span class="mf">0.0</span><span class="p">,</span>
                                  <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set macroscale loading</span>
    <span class="k">for</span> <span class="n">load_key</span> <span class="ow">in</span> <span class="n">loading_keywords</span><span class="p">:</span>
        <span class="c1"># Get load nature type</span>
        <span class="n">ltype</span> <span class="o">=</span> <span class="n">loading_keywords</span><span class="p">[</span><span class="n">load_key</span><span class="p">]</span>
        <span class="n">load_keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">load_key</span><span class="p">)</span>
        <span class="c1"># Loop over macroscale loading components</span>
        <span class="k">for</span> <span class="n">i_comp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dim</span><span class="o">**</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">component_line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span>
                <span class="n">file_path</span><span class="p">,</span> <span class="n">load_keyword_line_number</span> <span class="o">+</span> <span class="n">i_comp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">component_line</span><span class="p">:</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1"> th component.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">load_key</span><span class="p">,</span>
                                 <span class="n">i_comp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_line</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_load_subpaths</span><span class="p">[</span><span class="n">ltype</span><span class="p">]:</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1"> th component.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">load_key</span><span class="p">,</span>
                                 <span class="n">i_comp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkvalidname</span><span class="p">(</span><span class="n">component_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1"> th component.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">load_key</span><span class="p">,</span>
                                 <span class="n">i_comp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># Set component name</span>
            <span class="n">mac_load</span><span class="p">[</span><span class="n">ltype</span><span class="p">][</span><span class="n">i_comp</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">component_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Set component values for each loading subpath</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_load_subpaths</span><span class="p">[</span><span class="n">ltype</span><span class="p">]):</span>
                <span class="n">presc_val</span> <span class="o">=</span> <span class="n">component_line</span><span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checknumber</span><span class="p">(</span><span class="n">presc_val</span><span class="p">):</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1"> th component.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">load_key</span><span class="p">,</span>
                                     <span class="n">i_comp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">mac_load</span><span class="p">[</span><span class="n">ltype</span><span class="p">][</span><span class="n">i_comp</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">presc_val</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set macroscale prescription nature indexes</span>
    <span class="k">if</span> <span class="n">mac_load_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ltype</span> <span class="o">=</span> <span class="n">loading_keywords</span><span class="p">[</span><span class="s1">&#39;Macroscale_Strain&#39;</span><span class="p">]</span>
        <span class="n">mac_load_presctype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n_dim</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_load_subpaths</span><span class="p">[</span><span class="n">ltype</span><span class="p">]),</span>
                                     <span class="s1">&#39;strain&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mac_load_type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">ltype</span> <span class="o">=</span> <span class="n">loading_keywords</span><span class="p">[</span><span class="s1">&#39;Macroscale_Stress&#39;</span><span class="p">]</span>
        <span class="n">mac_load_presctype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n_dim</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_load_subpaths</span><span class="p">[</span><span class="n">ltype</span><span class="p">]),</span>
                                     <span class="s1">&#39;stress&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mac_load_type</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">mac_load_presctype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n_dim</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">n_load_subpaths</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span>
                                     <span class="s1">&#39;ND&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="n">presc_keyword</span> <span class="o">=</span> <span class="s1">&#39;Mixed_Prescription_Index&#39;</span>
        <span class="n">presc_keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">presc_keyword</span><span class="p">)</span>
        <span class="c1"># Loop over macroscale loading components</span>
        <span class="k">for</span> <span class="n">i_comp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dim</span><span class="o">**</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">component_line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span>
                <span class="n">file_path</span><span class="p">,</span> <span class="n">presc_keyword_line_number</span> <span class="o">+</span> <span class="n">i_comp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">component_line</span><span class="p">:</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1"> th component.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">load_key</span><span class="p">,</span>
                                 <span class="n">i_comp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># Set prescription nature indexes for each loading subpath</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">n_load_subpaths</span><span class="o">.</span><span class="n">values</span><span class="p">())):</span>
                <span class="n">presc_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">component_line</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">presc_val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1"> th component.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">load_key</span><span class="p">,</span>
                                     <span class="n">i_comp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ltype</span> <span class="o">=</span> <span class="s1">&#39;strain&#39;</span> <span class="k">if</span> <span class="n">presc_val</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;stress&#39;</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">n_load_subpaths</span><span class="p">[</span><span class="n">ltype</span><span class="p">]:</span>
                        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
                        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                            <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                            <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1"> th component.&#39;</span>
                        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">load_key</span><span class="p">,</span>
                                         <span class="n">i_comp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">mac_load_presctype</span><span class="p">[</span><span class="n">i_comp</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ltype</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check small strain formulation symmetry</span>
    <span class="k">if</span> <span class="n">strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">:</span>
        <span class="c1"># Set symmetric indexes (columnwise)</span>
        <span class="k">if</span> <span class="n">n_dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">symmetric_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">n_dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">symmetric_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
        <span class="c1"># Loop over symmetric indexes</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">symmetric_indexes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="c1"># Loop over loading subpaths</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">n_load_subpaths</span><span class="o">.</span><span class="n">values</span><span class="p">())):</span>
                <span class="c1"># Get load nature type</span>
                <span class="n">ltype</span> <span class="o">=</span> <span class="n">mac_load_presctype</span><span class="p">[</span><span class="n">symmetric_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">mac_load_type</span> <span class="o">==</span> <span class="mi">3</span> \
                        <span class="ow">and</span> <span class="n">mac_load_presctype</span><span class="p">[</span><span class="n">symmetric_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> \
                        <span class="o">!=</span> <span class="n">mac_load_presctype</span><span class="p">[</span><span class="n">symmetric_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Symmetric components prescribed with &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;different nature under infinitesimal strains&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Symmetric components must have the same &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;nature (strain or stress). Check </span><span class="si">{}</span><span class="s1"> th component.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span>
                                     <span class="s1">&#39;Mixed_Prescription_Index&#39;</span><span class="p">,</span> <span class="n">i_comp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="c1"># Check symmetry</span>
                <span class="n">isEqual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
                    <span class="n">mac_load</span><span class="p">[</span><span class="n">ltype</span><span class="p">][</span><span class="n">symmetric_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                    <span class="n">mac_load</span><span class="p">[</span><span class="n">ltype</span><span class="p">][</span><span class="n">symmetric_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">isEqual</span><span class="p">:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Nonsymmetric strain or stress components &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;prescribed under infinitesimal strains&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;A nonsymmetric </span><span class="si">{}</span><span class="s1"> tensor is prescribed &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;in the input data file under infinitesimal strains.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">ltype</span><span class="p">)</span>
                    <span class="c1"># Adopt symmetric component with the lowest first index</span>
                    <span class="n">mac_load</span><span class="p">[</span><span class="n">ltype</span><span class="p">][</span><span class="n">symmetric_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="n">mac_load</span><span class="p">[</span><span class="n">ltype</span><span class="p">][</span><span class="n">symmetric_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Sort macroscale strain and stress tensors according to the defined</span>
    <span class="c1"># problem nonsymmetric component order</span>
    <span class="k">if</span> <span class="n">n_dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;11&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;21&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;22&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;11&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;21&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;31&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;22&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;32&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;13&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
               <span class="s1">&#39;23&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;33&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
    <span class="n">mac_load_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mac_load</span><span class="p">)</span>
    <span class="n">mac_load_presctype_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mac_load_presctype</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dim</span><span class="o">**</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">mac_load_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">mac_load</span><span class="p">[</span><span class="s1">&#39;strain&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> \
                <span class="n">mac_load_copy</span><span class="p">[</span><span class="s1">&#39;strain&#39;</span><span class="p">][</span><span class="n">aux</span><span class="p">[</span><span class="n">comp_order_nsym</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">:]</span>
        <span class="k">elif</span> <span class="n">mac_load_type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">mac_load</span><span class="p">[</span><span class="s1">&#39;stress&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> \
                <span class="n">mac_load_copy</span><span class="p">[</span><span class="s1">&#39;stress&#39;</span><span class="p">][</span><span class="n">aux</span><span class="p">[</span><span class="n">comp_order_nsym</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">:]</span>
        <span class="k">elif</span> <span class="n">mac_load_type</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">mac_load</span><span class="p">[</span><span class="s1">&#39;strain&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> \
                <span class="n">mac_load_copy</span><span class="p">[</span><span class="s1">&#39;strain&#39;</span><span class="p">][</span><span class="n">aux</span><span class="p">[</span><span class="n">comp_order_nsym</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">:]</span>
            <span class="n">mac_load</span><span class="p">[</span><span class="s1">&#39;stress&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> \
                <span class="n">mac_load_copy</span><span class="p">[</span><span class="s1">&#39;stress&#39;</span><span class="p">][</span><span class="n">aux</span><span class="p">[</span><span class="n">comp_order_nsym</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">:]</span>
            <span class="n">mac_load_presctype</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> \
                <span class="n">mac_load_presctype_copy</span><span class="p">[</span><span class="n">aux</span><span class="p">[</span><span class="n">comp_order_nsym</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">:]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">mac_load</span><span class="p">,</span> <span class="n">mac_load_presctype</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_mac_load_increm"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_mac_load_increm.html#cratepy.ioput.readprocedures.read_mac_load_increm">[docs]</a><span class="k">def</span> <span class="nf">read_mac_load_increm</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">n_load_subpaths</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read macroscale loading incrementation.</span>

<span class="sd">    The specification of the data associated with the macroscale loading</span>
<span class="sd">    constraints has the following input data file syntax:</span>

<span class="sd">    *Option 1: Number_of_Load_Increments*</span>

<span class="sd">    This option entails a given number of equal-magnitude loading increments</span>
<span class="sd">    applied to each loading subpath.</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Number_of_Load_Increments &lt; int &gt;</span>


<span class="sd">    *Option 2: Increment_List*</span>

<span class="sd">    This option provides a general loading incrementation scheme.</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Increment_List</span>
<span class="sd">       [n_rep:] inc_load_fact[_inc_time] | [n_rep:] inc_load_fact[_inc_time] ..</span>
<span class="sd">       [n_rep:] inc_load_fact[_inc_time] | [n_rep:] inc_load_fact[_inc_time] ..</span>
<span class="sd">       [n_rep:] inc_load_fact[_inc_time] | [n_rep:] inc_load_fact[_inc_time] ..</span>

<span class="sd">    where `n_rep` (int) is the number of increment repetitions (optional,</span>
<span class="sd">    defaults to 1), `inc_load_fact` is the incremental load factor, and</span>
<span class="sd">    `inc_time` is the incremental time (optional, defaults to loading time</span>
<span class="sd">    factor times the absolute value of the incremental load factor).</span>
<span class="sd">    The delimiter `|` separates different loading subpaths.</span>

<span class="sd">    ----</span>

<span class="sd">    The optional specification of the data associated with the macroscale</span>
<span class="sd">    loading time factor has the following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Loading_Time_Factor</span>
<span class="sd">       &lt; float &gt;</span>

<span class="sd">    Unless explicitly specified in any way, the loading time factor provides</span>
<span class="sd">    the time associated with the macroscale loading incrementation. The</span>
<span class="sd">    incremental time is obtained by multiplying the loading time factor by the</span>
<span class="sd">    incremental loading factor. Defaults to 1.0 if not specified.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword : str</span>
<span class="sd">        Keyword.</span>
<span class="sd">    n_load_subpaths : int</span>
<span class="sd">        Number of loading subpaths.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mac_load_increm : dict</span>
<span class="sd">        For each loading subpath id (key, str), stores a numpy.ndarray of shape</span>
<span class="sd">        (n_load_increments, 2) where each row is associated with a prescribed</span>
<span class="sd">        loading increment, and the columns 0 and 1 contain the corresponding</span>
<span class="sd">        incremental load factor and incremental time, respectively.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Initialize macroscale loading incrementation dictionary</span>
    <span class="n">mac_load_increm</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="c1"># Set loading time factor</span>
    <span class="n">keyword_time</span> <span class="o">=</span> <span class="s1">&#39;Loading_Time_Factor&#39;</span>
    <span class="n">is_found</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">searchoptkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword_time</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_found</span><span class="p">:</span>
        <span class="n">load_time_factor</span> <span class="o">=</span> <span class="n">readtypeBkeyword</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_time</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">load_time_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="c1"># Set macroscale loading incrementation</span>
    <span class="k">if</span> <span class="n">keyword</span> <span class="o">==</span> <span class="s1">&#39;Number_of_Load_Increments&#39;</span><span class="p">:</span>
        <span class="n">max_val</span> <span class="o">=</span> <span class="s1">&#39;~&#39;</span>
        <span class="n">n_load_increments</span> <span class="o">=</span> <span class="n">readtypeAkeyword</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
        <span class="c1"># Build macroscale loading incrementation dictionary</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_load_subpaths</span><span class="p">):</span>
            <span class="c1"># Set loading subpath default total load factor</span>
            <span class="n">total_lfact</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="c1"># Build macroscale loading subpath</span>
            <span class="n">load_subpath</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_load_increments</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">load_subpath</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_lfact</span><span class="o">/</span><span class="n">n_load_increments</span>
            <span class="n">load_subpath</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">load_time_factor</span><span class="o">*</span><span class="n">load_subpath</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Store macroscale loading subpath</span>
            <span class="n">mac_load_increm</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">load_subpath</span>
    <span class="k">elif</span> <span class="n">keyword</span> <span class="o">==</span> <span class="s1">&#39;Increment_List&#39;</span><span class="p">:</span>
        <span class="c1"># Find keyword line number</span>
        <span class="n">keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="c1"># Initialize macroscale loading increment array</span>
        <span class="n">increm_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_load_subpaths</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="c1"># Read increment specification line</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_line_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">increm_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)]</span>
        <span class="c1"># At least one increment specification line must be provided for each</span>
        <span class="c1"># macroscale loading subpath</span>
        <span class="n">is_empty_line</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">is_empty_line</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">increm_line</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_load_subpaths</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid loading increment list&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined&#39;</span> \
                <span class="o">+</span> <span class="s1">&#39; in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;The first line of the increment list must &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;contain only one macroscale loading increment&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;specification for each macroscale loading subpath.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Build macroscale loading increment array</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">is_empty_line</span><span class="p">:</span>
            <span class="n">increm_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">increm_list</span><span class="p">,</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_load_subpaths</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                            <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1"># Assemble macroscale increment specification line</span>
            <span class="n">increm_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">increm_line</span><span class="p">)]</span> <span class="o">=</span> <span class="n">increm_line</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># Read increment specification line</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_line_number</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">is_empty_line</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="n">increm_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)]</span>
        <span class="c1"># Build macroscale loading incrementation dictionary</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_load_subpaths</span><span class="p">):</span>
            <span class="c1"># Initialize macroscale loading subpath</span>
            <span class="n">load_subpath</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
            <span class="c1"># Loop over increment specifications</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">increm_list</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="c1"># Get increment specification</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">increm_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                <span class="c1"># Decode increment specification</span>
                <span class="k">if</span> <span class="n">spec</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rep</span><span class="p">,</span> <span class="n">inc_lfact</span><span class="p">,</span> <span class="n">inc_time</span> <span class="o">=</span> \
                        <span class="n">decode_increm_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">load_time_factor</span><span class="p">)</span>
                <span class="c1"># Build macroscale loading subpath</span>
                <span class="n">load_subpath</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">load_subpath</span><span class="p">,</span>
                                         <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="n">inc_lfact</span><span class="p">,</span> <span class="n">inc_time</span><span class="p">],</span>
                                                 <span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1"># Store macroscale loading subpath</span>
            <span class="n">mac_load_increm</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)]</span> <span class="o">=</span> <span class="n">load_subpath</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Unknown macroscale loading keyword</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Unknown loading incrementation keyword&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;A unknown macroscale loading incrementation keyword &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;has been specified in the input data file.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
    <span class="c1"># Return</span>
    <span class="k">return</span> <span class="n">mac_load_increm</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="decode_increm_spec"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.decode_increm_spec.html#cratepy.ioput.readprocedures.decode_increm_spec">[docs]</a><span class="k">def</span> <span class="nf">decode_increm_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">load_time_factor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decode macroscale loading increment specification.</span>

<span class="sd">    A macroscale loading increment specification has the format</span>
<span class="sd">    `[n_rep:] inc_load_fact[_inc_time]` where `n_rep` (int) is the number of</span>
<span class="sd">    increment repetitions (optional, defaults to 1), `inc_load_fact` is the</span>
<span class="sd">    incremental load factor, and `inc_time` is the incremental time (optional,</span>
<span class="sd">    defaults to loading time factor times the absolute value of the incremental</span>
<span class="sd">    load factor).</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    spec : str</span>
<span class="sd">        Macroscale loading increment specification.</span>
<span class="sd">    load_time_factor : float</span>
<span class="sd">        Loading time factor.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    n_rep : int</span>
<span class="sd">        Number of increment repetitions.</span>
<span class="sd">    inc_lfact : float</span>
<span class="sd">        Incremental load factor.</span>
<span class="sd">    inc_time : float</span>
<span class="sd">        Incremental time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Split specifications based on multiple delimiters</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[:_]&#39;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
    <span class="c1"># Check if the repetition and incremental time have been specified</span>
    <span class="n">has_rep</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[:_]&#39;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
    <span class="n">has_time</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[:_]&#39;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid loading increment&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;A macroscale loading increment specification in &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;the input data file is invalid.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
    <span class="c1"># Set macroscale loading increment parameters</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">n_rep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">code</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">has_rep</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="n">inc_lfact</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">code</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">has_rep</span><span class="p">)])</span>
        <span class="n">inc_time</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">code</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> \
            <span class="k">if</span> <span class="n">has_time</span> <span class="k">else</span> <span class="n">load_time_factor</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">inc_lfact</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid loading increment&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;A macroscale loading increment specification in &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;the input data file is invalid.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">n_rep</span><span class="p">,</span> <span class="n">inc_time</span><span class="p">]]):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid loading increment optinal parameters&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The number of repetitions or incremental time &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;prescribed for a given macroscale loading&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;increment in the input data file is invalid.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
    <span class="c1"># Return</span>
    <span class="k">return</span> <span class="n">n_rep</span><span class="p">,</span> <span class="n">inc_lfact</span><span class="p">,</span> <span class="n">inc_time</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_phase_clustering"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_phase_clustering.html#cratepy.ioput.readprocedures.read_phase_clustering">[docs]</a><span class="k">def</span> <span class="nf">read_phase_clustering</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">n_material_phases</span><span class="p">,</span>
                          <span class="n">material_properties</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read (base) number of clusters associated with each material phase.</span>

<span class="sd">    The specification of the data associated with the material phases (base)</span>
<span class="sd">    number of clusters has the following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Number_of_Clusters</span>
<span class="sd">       &lt; phase_id &gt; &lt; n_clusters &gt;</span>
<span class="sd">       &lt; phase_id &gt; &lt; n_clusters &gt;</span>
<span class="sd">       ...</span>

<span class="sd">    where `phase_id` (int) is the material identifier and `n_clusters` is the</span>
<span class="sd">    corresponding (base) number of clusters.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword : str</span>
<span class="sd">        Keyword.</span>
<span class="sd">    n_material_phases : int</span>
<span class="sd">        Number of material phases.</span>
<span class="sd">    material_properties : dict</span>
<span class="sd">        Constitutive model material properties (key, str) values</span>
<span class="sd">        (item, {int, float, bool}).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    phase_n_clusters : dict</span>
<span class="sd">        Number of clusters (item, int) associated with each material phase</span>
<span class="sd">        (key, str).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">phase_n_clusters</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">iphase</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_material_phases</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span> <span class="o">+</span> <span class="n">iphase</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1">th material phase.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">iphase</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1">th material phase.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">iphase</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> \
                <span class="ow">or</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1">th material phase.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">iphase</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">material_properties</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1">th material phase.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">iphase</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="ow">in</span> <span class="n">phase_n_clusters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;Check </span><span class="si">{}</span><span class="s1">th material phase.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">iphase</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">phase_n_clusters</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">phase_n_clusters</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_cluster_analysis_scheme"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_cluster_analysis_scheme.html#cratepy.ioput.readprocedures.read_cluster_analysis_scheme">[docs]</a><span class="k">def</span> <span class="nf">read_cluster_analysis_scheme</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">material_phases</span><span class="p">,</span>
                                 <span class="n">clustering_features</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read cluster analysis scheme.</span>

<span class="sd">    The specification of the data associated with the cluster analysis scheme</span>
<span class="sd">    has the following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Clustering_Analysis_Scheme</span>
<span class="sd">       &lt; phase_id &gt; &lt; clustering_type &gt;</span>
<span class="sd">           base_clustering</span>
<span class="sd">           &lt; clustering_algorithm_id &gt; &lt; feature_id &gt; [&lt; feature_id &gt;]</span>
<span class="sd">           adaptive_clustering</span>
<span class="sd">           &lt; clustering_algorithm_id &gt; &lt; feature_id &gt; [&lt; feature_id &gt;]</span>
<span class="sd">           adaptivity_parameters &lt; adapt_criterion_id &gt; &lt; adapt_type_id &gt;</span>
<span class="sd">           &lt; adapt_parameter_name &gt; &lt; value &gt;</span>
<span class="sd">           &lt; adapt_parameter_name &gt; &lt; value &gt;</span>
<span class="sd">       &lt; phase_id &gt; &lt; clustering_type &gt;</span>
<span class="sd">       ...</span>

<span class="sd">    where `phase_id` (int) is the material identifier, `clustering_type` is the</span>
<span class="sd">    clustering type ({static, adaptive}), `clustering_algorithm_id` (int) is</span>
<span class="sd">    the clustering algorithm identifier, `feature_id` (int) is the clustering</span>
<span class="sd">    feature identifier, `adapt_criterion_id`(int) is the clustering</span>
<span class="sd">    adaptivity criterion identifier, `adapt_type_id` (int) is the adaptive</span>
<span class="sd">    cluster-reduced material phase type identifier, and `adapt_parameter_name`</span>
<span class="sd">    is the adaptive parameter name.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword : str</span>
<span class="sd">        Keyword.</span>
<span class="sd">    material_phases : list[str]</span>
<span class="sd">        RVE material phases labels (str).</span>
<span class="sd">    clustering_features : list[str]</span>
<span class="sd">        Available clustering features.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    clustering_type : dict</span>
<span class="sd">        Clustering type (item, {&#39;static&#39;, &#39;adaptive&#39;}) of each material phase</span>
<span class="sd">        (key, str).</span>
<span class="sd">    base_clustering_scheme : dict</span>
<span class="sd">        Prescribed base clustering scheme (item, numpy.ndarray of shape</span>
<span class="sd">        (n_clusterings, 3)) for each material phase (key, str). Each row is</span>
<span class="sd">        associated with a unique clustering characterized by a clustering</span>
<span class="sd">        algorithm (col 1, int), a list of features (col 2, list[int]) and a</span>
<span class="sd">        list of the features data matrix&#39; indexes (col 3, list[int]).</span>
<span class="sd">    adaptive_clustering_scheme : dict</span>
<span class="sd">        Prescribed adaptive clustering scheme (item, numpy.ndarray of shape</span>
<span class="sd">        (n_clusterings, 3)) for each material phase (key, str). Each row is</span>
<span class="sd">        associated with a unique clustering characterized by a clustering</span>
<span class="sd">        algorithm (col 1, int), a list of features (col 2, list[int]) and a</span>
<span class="sd">        list of the features data matrix&#39; indexes (col 3, list[int]).</span>
<span class="sd">    adapt_criterion_data : dict</span>
<span class="sd">        Clustering adaptivity criterion (item, dict) associated with each</span>
<span class="sd">        material phase (key, str). This dictionary contains the adaptivity</span>
<span class="sd">        criterion to be used and the required parameters.</span>
<span class="sd">    adaptivity_type : dict</span>
<span class="sd">        Clustering adaptivity type (item, dict) associated with each material</span>
<span class="sd">        phase (key, str). This dictionary contains the adaptivity type to be</span>
<span class="sd">        used and the required parameters.</span>
<span class="sd">    adaptivity_control_feature : dict</span>
<span class="sd">        Clustering adaptivity control feature (item, str) associated with each</span>
<span class="sd">        material phase (key, str).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Find keyword line number</span>
    <span class="n">keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># Initialize line number</span>
    <span class="n">line_number</span> <span class="o">=</span> <span class="n">keyword_line_number</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Initialize clustering type</span>
    <span class="n">clustering_type</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Initialize base clustering scheme</span>
    <span class="n">base_clustering_scheme</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Initialize adaptive clustering scheme and adaptivity related dictionaries</span>
    <span class="n">adaptive_clustering_scheme</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">adapt_criterion_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">adaptivity_type</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">adaptivity_control_feature</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Loop over material phases</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">material_phases</span><span class="p">)):</span>
        <span class="c1"># Increment line number and read line</span>
        <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span>
        <span class="n">is_empty_line</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="c1"># Read material phase and clustering type</span>
        <span class="k">if</span> <span class="n">is_empty_line</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing clustering scheme for material phase&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span>\
                <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;The clustering scheme must be specified for all &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;material phases.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">material_phases</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Unknown material phase&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown material phase.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">mat_phase</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ctype</span> <span class="o">=</span> <span class="s1">&#39;static&#39;</span>
            <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;adaptive&#39;</span><span class="p">]:</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Unknown clustering type&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown clustering type.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mat_phase</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ctype</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Initialize material phase base clustering</span>
        <span class="n">base_clustering_scheme</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="c1"># Store material phase clustering type</span>
        <span class="n">clustering_type</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctype</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Increment line number and read line</span>
        <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span>
        <span class="n">is_empty_line</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Read base clustering scheme</span>
        <span class="k">if</span> <span class="n">is_empty_line</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;base_clustering&#39;</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing base clustering scheme&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing base clustering scheme of material &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Read base clustering scheme</span>
            <span class="n">base_clustering_scheme</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">],</span> <span class="n">line_number</span> <span class="o">=</span> \
                <span class="n">read_clustering_scheme</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Skip to the next material phase if static cluster-reduced material</span>
        <span class="c1"># phase, otherwise read following line</span>
        <span class="k">if</span> <span class="n">ctype</span> <span class="o">==</span> <span class="s1">&#39;static&#39;</span><span class="p">:</span>
            <span class="c1"># Get static cluster-reduced material phase valid clustering</span>
            <span class="c1"># algorithms</span>
            <span class="n">valid_algorithms</span> <span class="o">=</span> <span class="n">SCRMP</span><span class="o">.</span><span class="n">get_valid_clust_algs</span><span class="p">()</span>
            <span class="c1"># Check validity of prescribed base clustering scheme</span>
            <span class="n">check_clustering_scheme</span><span class="p">(</span>
                <span class="n">mat_phase</span><span class="p">,</span> <span class="n">base_clustering_scheme</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">],</span> <span class="n">valid_algorithms</span><span class="p">,</span>
                <span class="n">clustering_features</span><span class="p">)</span>
            <span class="c1"># Skip to the next material phase</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Initialize material phase adaptivity related dictionaries</span>
            <span class="n">adapt_criterion_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">adaptivity_type</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># Read following line</span>
            <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span>
            <span class="n">is_empty_line</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Read adaptive clustering scheme</span>
        <span class="k">if</span> <span class="n">is_empty_line</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;adaptive_clustering&#39;</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing adaptive clustering scheme&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing adaptive clustering scheme of adaptive &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Read adaptive clustering scheme</span>
            <span class="n">adaptive_clustering_scheme</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">],</span> <span class="n">line_number</span> <span class="o">=</span> \
                <span class="n">read_clustering_scheme</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Increment line number and read line</span>
        <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span>
        <span class="n">is_empty_line</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Read adaptivity parameters</span>
        <span class="k">if</span> <span class="n">is_empty_line</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;adaptivity_parameters&#39;</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing adaptivity parameters of clustering scheme&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing adaptivity parameters of clustering &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;scheme of adaptive material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Read adaptivity criterion and adaptivity type</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> \
                    <span class="n">AdaptivityManager</span><span class="o">.</span><span class="n">get_adaptivity_criterions</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Unknown adaptivity criterion&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown adaptivity criterion on clustering &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;scheme of adaptive material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CRVE</span><span class="o">.</span><span class="n">get_crmp_types</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Unknown adaptivity type&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown adaptivity type on clustering &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;scheme of adaptive material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Read adaptivity criterion</span>
                <span class="n">adapt_criterion_id</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">adapt_crit</span> <span class="o">=</span> <span class="n">AdaptivityManager</span><span class="o">.</span><span class="n">get_adaptivity_criterions</span><span class="p">()[</span>
                    <span class="n">adapt_criterion_id</span><span class="p">]</span>
                <span class="n">adapt_criterion_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="s1">&#39;criterion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adapt_crit</span>
                <span class="c1"># Read adaptivity type</span>
                <span class="n">adapt_type_id</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">adapt_type</span> <span class="o">=</span> <span class="n">CRVE</span><span class="o">.</span><span class="n">get_crmp_types</span><span class="p">()[</span><span class="n">adapt_type_id</span><span class="p">]</span>
                <span class="n">adaptivity_type</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="s1">&#39;adapt_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adapt_type</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Get adaptive cluster-reduced material phase valid clustering</span>
        <span class="c1"># algorithms</span>
        <span class="n">valid_algorithms</span> <span class="o">=</span> <span class="n">adapt_type</span><span class="o">.</span><span class="n">get_valid_clust_algs</span><span class="p">()</span>
        <span class="c1"># Check validity of prescribed base clustering scheme</span>
        <span class="n">check_clustering_scheme</span><span class="p">(</span>
            <span class="n">mat_phase</span><span class="p">,</span> <span class="n">adaptive_clustering_scheme</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">],</span> <span class="n">valid_algorithms</span><span class="p">,</span>
            <span class="n">clustering_features</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Get mandatory and optional adaptivity criterion parameters</span>
        <span class="n">macp</span><span class="p">,</span> <span class="n">oacp</span> <span class="o">=</span> <span class="n">adapt_crit</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
        <span class="c1"># Get mandatory and optional adaptivity type parameters</span>
        <span class="n">matp</span><span class="p">,</span> <span class="n">oatp</span> <span class="o">=</span> <span class="n">adapt_type</span><span class="o">.</span><span class="n">get_adaptivity_type_parameters</span><span class="p">()</span>
        <span class="c1"># Collect all mandatory and optional adaptivity parameters</span>
        <span class="n">madapt_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">macp</span><span class="p">,</span> <span class="o">**</span><span class="n">matp</span><span class="p">}</span>
        <span class="n">oadapt_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">oacp</span><span class="p">,</span> <span class="o">**</span><span class="n">oatp</span><span class="p">}</span>
        <span class="c1"># Set the optional parameters default values by default</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">oadapt_parameters</span><span class="p">:</span>
            <span class="c1"># Optional adaptivity criterion parameters</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">oacp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># Store adaptivity criterion parameter</span>
                <span class="n">adapt_criterion_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">get_formatted_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">oacp</span><span class="p">[</span><span class="n">parameter</span><span class="p">])</span>
            <span class="c1"># Optional adaptivity type parameters</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Store adaptivity type parameter</span>
                <span class="n">adaptivity_type</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">get_formatted_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">oatp</span><span class="p">[</span><span class="n">parameter</span><span class="p">])</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Read following line</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">is_empty_line</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="c1"># Check for adaptivity parameters specifications</span>
        <span class="n">is_adapt_parameter</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">is_empty_line</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="n">madapt_parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                                 <span class="o">*</span><span class="n">oadapt_parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                                 <span class="s1">&#39;adaptivity_control_feature&#39;</span><span class="p">]:</span>
            <span class="n">is_adapt_parameter</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">parameter</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">while</span> <span class="n">is_adapt_parameter</span><span class="p">:</span>
            <span class="c1"># Increment line number and read line</span>
            <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Check parameter specification</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing adaptivity parameter value&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing value of adaptivity parameter on &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;clustering scheme of adaptive material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
            <span class="c1"># Get adaptivity parameter</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">macp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># Store adaptivity criterion parameter</span>
                <span class="n">adapt_criterion_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">get_formatted_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                            <span class="n">etype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">macp</span><span class="p">[</span><span class="n">parameter</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">matp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># Store adaptivity type parameter</span>
                <span class="n">adaptivity_type</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">get_formatted_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                            <span class="n">etype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">matp</span><span class="p">[</span><span class="n">parameter</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">oacp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># Get parameter value</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">get_formatted_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="c1"># Store adaptivity criterion parameter</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">oacp</span><span class="p">[</span><span class="n">parameter</span><span class="p">])):</span>
                    <span class="n">adapt_criterion_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="n">get_formatted_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span>
                                                <span class="nb">type</span><span class="p">(</span><span class="n">oacp</span><span class="p">[</span><span class="n">parameter</span><span class="p">])(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid adaptivity parameter specification&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Check adaptivity parameter </span><span class="si">{}</span><span class="s1"> on &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;clustering scheme of adaptive material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                                     <span class="n">parameter</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">oatp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># Get parameter value</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">get_formatted_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="c1"># Store adaptivity type parameter</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">oatp</span><span class="p">[</span><span class="n">parameter</span><span class="p">])):</span>
                    <span class="n">adaptivity_type</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="n">get_formatted_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span>
                                                <span class="nb">type</span><span class="p">(</span><span class="n">oatp</span><span class="p">[</span><span class="n">parameter</span><span class="p">])(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid adaptivity parameter specification&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Check adaptivity parameter </span><span class="si">{}</span><span class="s1"> on &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;clustering scheme of adaptive material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                                     <span class="n">parameter</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">parameter</span> <span class="o">==</span> <span class="s1">&#39;adaptivity_control_feature&#39;</span><span class="p">:</span>
                <span class="c1"># Store adaptivity control feature</span>
                <span class="k">if</span> <span class="n">mat_phase</span> <span class="ow">in</span> <span class="n">adaptivity_control_feature</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Multiple adaptivity control features&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Only one adaptivity control feature &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;can be prescribed in the clustering scheme &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;of adaptive&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                                     <span class="n">mat_phase</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">adaptivity_control_feature</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Read following line</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">is_empty_line</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="c1"># Check for adaptivity parameters specifications. If there are no</span>
            <span class="c1"># adaptivity parameters specifications, skip to the next material</span>
            <span class="c1"># phase</span>
            <span class="n">is_adapt_parameter</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">is_empty_line</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">material_phases</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing clustering scheme&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;The clustering scheme must be specified &#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;for all material phases.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="n">madapt_parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                                     <span class="o">*</span><span class="n">oadapt_parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                                     <span class="s1">&#39;adaptivity_control_feature&#39;</span><span class="p">]:</span>
                <span class="n">is_adapt_parameter</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">parameter</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Check if all the mandatory adaptivity criterion parameters have been</span>
        <span class="c1"># prescribed</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">macp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">adapt_criterion_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing mandatory adaptivity criterion parameter&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing mandatory parameter - </span><span class="si">{}</span><span class="s1"> - of &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;adaptive material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                                 <span class="n">parameter</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
        <span class="c1"># Check if all the mandatory adaptivity type parameters have been</span>
        <span class="c1"># prescribed</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">matp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">adaptivity_type</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing mandatory adaptivity type parameter&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing mandatory parameter - </span><span class="si">{}</span><span class="s1"> - of &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;adaptive material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                                 <span class="n">parameter</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
        <span class="c1"># Check if adaptivity control feature has been prescribed</span>
        <span class="k">if</span> <span class="n">mat_phase</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">adaptivity_control_feature</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing adaptivity control feature&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing adaptivity control feature of &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;adaptive material phase </span><span class="si">{}</span><span class="s1">.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
        <span class="c1"># Set default values for all the optional adaptivity criterion</span>
        <span class="c1"># parameters that have not been prescribed</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">oacp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">adapt_criterion_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">adapt_criterion_data</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">oacp</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>
        <span class="c1"># Set default values for all the optional adaptivity type parameters</span>
        <span class="c1"># that have not been prescribed</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">oatp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">adaptivity_type</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">adaptivity_type</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">oatp</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check if the cluster analysis scheme has been prescribed for all material</span>
    <span class="c1"># phases</span>
    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">base_clustering_scheme</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">material_phases</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing clustering scheme&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;The clustering scheme must be specified for all &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;material phases.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">clustering_type</span><span class="p">,</span> <span class="n">base_clustering_scheme</span><span class="p">,</span> \
        <span class="n">adaptive_clustering_scheme</span><span class="p">,</span> <span class="n">adapt_criterion_data</span><span class="p">,</span> <span class="n">adaptivity_type</span><span class="p">,</span> \
        <span class="n">adaptivity_control_feature</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_clustering_scheme"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_clustering_scheme.html#cratepy.ioput.readprocedures.read_clustering_scheme">[docs]</a><span class="k">def</span> <span class="nf">read_clustering_scheme</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read material phase&#39;s prescribed clustering scheme.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    line_number : int</span>
<span class="sd">        Data file line where the material phase&#39;s clustering scheme</span>
<span class="sd">        prescription begins.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    clustering_scheme : numpy.ndarray of shape (n_clusterings, 3)</span>
<span class="sd">        Clustering scheme stored as a numpy.ndarray of shape</span>
<span class="sd">        (n_clusterings, 3). Each row is associated with a unique clustering</span>
<span class="sd">        characterized by a clustering algorithm (col 1, int), a list of</span>
<span class="sd">        clustering features (col 2, list[int]), and a list of the clustering</span>
<span class="sd">        features data matrix&#39; indexes (col 3, list[int]).</span>
<span class="sd">    line_number : int</span>
<span class="sd">        Data file line where the material phase&#39;s clustering scheme</span>
<span class="sd">        prescription ends.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Initialize clustering scheme</span>
    <span class="n">clustering_scheme</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Read line</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="c1"># Check number of prescribed clusterings. If not specified, then assume a</span>
    <span class="c1"># single clustering solution</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid number of clusterings&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The number of clusterings of a given clustering &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;scheme specified in the input data file&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;is invalid.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_clusterings</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_clusterings</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Loop over prescribed clustering solutions</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clusterings</span><span class="p">):</span>
        <span class="c1"># Increment line number and read line</span>
        <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="c1"># Check clustering solution</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid clustering algorithm or feature identifier&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;A clustering algorithm or feature specified in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file is invalid.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
        <span class="c1"># Append clustering solution to clustering scheme</span>
        <span class="n">clustering_scheme</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">clustering_scheme</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Assemble clustering solution</span>
        <span class="n">clustering_scheme</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">clustering_scheme</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return</span>
    <span class="k">return</span> <span class="n">clustering_scheme</span><span class="p">,</span> <span class="n">line_number</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="check_clustering_scheme"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.check_clustering_scheme.html#cratepy.ioput.readprocedures.check_clustering_scheme">[docs]</a><span class="k">def</span> <span class="nf">check_clustering_scheme</span><span class="p">(</span><span class="n">mat_phase</span><span class="p">,</span> <span class="n">clustering_scheme</span><span class="p">,</span> <span class="n">valid_algorithms</span><span class="p">,</span>
                            <span class="n">valid_features</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check material phase&#39;s prescribed clustering scheme.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mat_phase : str</span>
<span class="sd">        Material phase label.</span>
<span class="sd">    clustering_scheme : numpy.ndarray of shape (n_clusterings, 3)</span>
<span class="sd">        Clustering scheme stored as a numpy.ndarray of shape</span>
<span class="sd">        (n_clusterings, 3). Each row is associated with a unique clustering</span>
<span class="sd">        characterized by a clustering algorithm (col 1, int), a list of</span>
<span class="sd">        clustering features (col 2, list[int]), and a list of the clustering</span>
<span class="sd">        features data matrix&#39; indexes (col 3, list[int]).</span>
<span class="sd">    valid_algorithms : list[str]</span>
<span class="sd">        Valid clustering algorithms identifiers (str).</span>
<span class="sd">    valid_features : list[str]</span>
<span class="sd">        Valid clustering features identifiers (str).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check validity of prescribed clustering algorithms</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_algorithms</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">clustering_scheme</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]):</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid clustering algorithm&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;A clustering algorithm prescribed in the clustering &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;scheme of material phase </span><span class="si">{}</span><span class="s1"> in the&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;input data file is invalid.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span>
    <span class="c1"># Check validity of prescribed clustering features</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">clustering_scheme</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_features</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">clustering_scheme</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid clustering feature&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;A clustering feature prescribed in the clustering &#39;</span>\
                <span class="o">+</span> <span class="s1">&#39;scheme of material phase </span><span class="si">{}</span><span class="s1"> in the&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;input data file is invalid.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">mat_phase</span><span class="p">)</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_adaptivity_frequency"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_adaptivity_frequency.html#cratepy.ioput.readprocedures.read_adaptivity_frequency">[docs]</a><span class="k">def</span> <span class="nf">read_adaptivity_frequency</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">adapt_material_phases</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read clustering adaptivity frequency.</span>

<span class="sd">    The specification of the data associated with the clustering adaptivity</span>
<span class="sd">    frequency has the following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Adaptivity_Frequency</span>
<span class="sd">       &lt; phase_id &gt; &lt; option &gt;</span>
<span class="sd">       &lt; phase_id &gt; &lt; option &gt;</span>

<span class="sd">    where `phase_id` (int) is the material identifier and `option` is the</span>
<span class="sd">    corresponding clustering adaptivity frequency ({none, all, every &lt; int &gt;})</span>
<span class="sd">    with respect to the loading incrementation.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword: str</span>
<span class="sd">        Keyword.</span>
<span class="sd">    adapt_material_phases : list[str]</span>
<span class="sd">        RVE adaptive material phases labels (str).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    clust_adapt_freq : dict, default=None</span>
<span class="sd">        Clustering adaptivity frequency (relative to loading incrementation)</span>
<span class="sd">        (item, int) associated with each adaptive cluster-reduced material</span>
<span class="sd">        phase (key, str).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Find keyword line number</span>
    <span class="n">keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># Initialize line number</span>
    <span class="n">line_number</span> <span class="o">=</span> <span class="n">keyword_line_number</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Initialize clustering adaptivity frequency</span>
    <span class="n">clust_adapt_freq</span> <span class="o">=</span> <span class="p">{</span><span class="n">mat_phase</span><span class="p">:</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">mat_phase</span> <span class="ow">in</span> <span class="n">adapt_material_phases</span><span class="p">}</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Read following line</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">is_empty_line</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="c1"># Check for adaptivity frequency specifications. If there are no adaptivity</span>
    <span class="c1"># frequency specifications, return</span>
    <span class="k">if</span> <span class="n">is_empty_line</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">clust_adapt_freq</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># Increment line number and read line</span>
        <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="c1"># Check adaptivity frequency specification</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing adaptivity frequency specification.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">adapt_material_phases</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown adaptive material phase.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;every&#39;</span><span class="p">]:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown adaptivity frequency option.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="c1"># Get material phase and adaptivity frequency option</span>
        <span class="n">mat_phase</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Set adaptivity frequency</span>
        <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">clust_adapt_freq</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;every&#39;</span><span class="p">:</span>
            <span class="c1"># Check option specification</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
                    <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid adaptivity frequency option.&#39;</span>
                <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">clust_adapt_freq</span><span class="p">[</span><span class="n">mat_phase</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Read following line</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">is_empty_line</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="c1"># Check for adaptivity frequency specifications. If there are no</span>
        <span class="c1"># adaptivity frequency specifications, return</span>
        <span class="k">if</span> <span class="n">is_empty_line</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">clust_adapt_freq</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_rewind_state_parameters"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_rewind_state_parameters.html#cratepy.ioput.readprocedures.read_rewind_state_parameters">[docs]</a><span class="k">def</span> <span class="nf">read_rewind_state_parameters</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read the solution rewind state criterion parameters.</span>

<span class="sd">    The specification of the data associated with the solution rewind state</span>
<span class="sd">    criterion has the following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">       :linenos:</span>
<span class="sd">       :emphasize-lines: 2</span>

<span class="sd">       Analysis_Rewinding</span>
<span class="sd">       Analysis_Rewind_State_Criterion &lt; criterion &gt; &lt; parameter_value &gt;</span>
<span class="sd">       Analysis_Rewinding_Criterion &lt; criterion &gt; &lt; parameter_value &gt;</span>
<span class="sd">       [Max_Number_of_Rewinds &lt; int &gt;]</span>

<span class="sd">    where `criterion` (str) is the solution rewind state criterion name and</span>
<span class="sd">    `parameter_value` ({int, float}) is the corresponding parameter value.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword: str</span>
<span class="sd">        Keyword.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rewind_state_criterion : tuple</span>
<span class="sd">        Rewind state storage criterion [0] and associated parameter [1].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Find keyword line number</span>
    <span class="n">keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># Get keyword lowercased line</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checknumber</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing rewind state storage criterion specification.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Get available rewind state storage criteria and associated default</span>
    <span class="c1"># parameters</span>
    <span class="n">available_criteria</span> <span class="o">=</span> <span class="n">RewindManager</span><span class="o">.</span><span class="n">get_save_rewind_state_criteria</span><span class="p">()</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Get rewind state storage criterion</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">available_criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown rewind state storage criterion.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># Get rewind state storage criterion parameter</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># Get specified parameter</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="n">get_formatted_parameter</span><span class="p">(</span>
            <span class="n">criterion</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">etype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">available_criteria</span><span class="p">[</span><span class="n">criterion</span><span class="p">]))</span>
        <span class="c1"># Set rewind state storage criterion</span>
        <span class="n">rewind_state_criterion</span> <span class="o">=</span> <span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing rewind state storage criterion parameter.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">rewind_state_criterion</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_rewinding_criterion_parameters"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_rewinding_criterion_parameters.html#cratepy.ioput.readprocedures.read_rewinding_criterion_parameters">[docs]</a><span class="k">def</span> <span class="nf">read_rewinding_criterion_parameters</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read the solution rewinding criterion parameters.</span>

<span class="sd">    The specification of the data associated with the solution rewind criterion</span>
<span class="sd">    criterion has the following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">       :linenos:</span>
<span class="sd">       :emphasize-lines: 3</span>

<span class="sd">       Analysis_Rewinding</span>
<span class="sd">       Analysis_Rewind_State_Criterion &lt; criterion &gt; &lt; parameter_value &gt;</span>
<span class="sd">       Analysis_Rewinding_Criterion &lt; criterion &gt; &lt; parameter_value &gt;</span>
<span class="sd">       [Max_Number_of_Rewinds &lt; int &gt;]</span>

<span class="sd">    where `criterion` (str) is the solution rewind criterion name and</span>
<span class="sd">    `parameter_value` ({int, float}) is the corresponding parameter value.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword: str</span>
<span class="sd">        Keyword.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rewinding_criterion : tuple, default=None</span>
<span class="sd">        Rewinding criterion [0] and associated parameter [1].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Find keyword line number</span>
    <span class="n">keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># Get keyword lowercased line</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checknumber</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing rewinding criterion specification.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Get available rewinding criteria and associated default parameters</span>
    <span class="n">available_criteria</span> <span class="o">=</span> <span class="n">RewindManager</span><span class="o">.</span><span class="n">get_rewinding_criteria</span><span class="p">()</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Get rewinding criterion</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">available_criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown rewinding criterion.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># Get rewinding criterion parameter</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># Get specified parameter</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="n">get_formatted_parameter</span><span class="p">(</span>
            <span class="n">criterion</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">etype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">available_criteria</span><span class="p">[</span><span class="n">criterion</span><span class="p">]))</span>
        <span class="c1"># Set rewinding criterion</span>
        <span class="n">rewinding_criterion</span> <span class="o">=</span> <span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing rewinding criterion parameter.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">rewinding_criterion</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_discretization_file_path"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_discretization_file_path.html#cratepy.ioput.readprocedures.read_discretization_file_path">[docs]</a><span class="k">def</span> <span class="nf">read_discretization_file_path</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">valid_exts</span><span class="p">,</span>
                                  <span class="n">discret_file_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read spatial discretization file path.</span>

<span class="sd">    The specification of the spatial discretization file path has the following</span>
<span class="sd">    input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Discretization_File</span>
<span class="sd">       &lt; path &gt;</span>

<span class="sd">    where `path` is the path of the spatial discretization file.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword: str</span>
<span class="sd">        Keyword.</span>
<span class="sd">    valid_exts : tuple[str]</span>
<span class="sd">        Valid extensions of spatial discretization file.</span>
<span class="sd">    discret_file_dir : str, default=None</span>
<span class="sd">        Spatial discretization file directory path.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    discret_file_path : str</span>
<span class="sd">        Spatial discretization file path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="n">line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">discret_file_path</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check if spatial discretization file directory path was provided</span>
    <span class="k">if</span> <span class="n">discret_file_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If spatial discretization file absolute path is not provided, then</span>
        <span class="c1"># build it from provided relative path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">discret_file_path</span><span class="p">):</span>
            <span class="n">discret_file_path</span> <span class="o">=</span> <span class="n">discret_file_dir</span> <span class="o">+</span> <span class="n">discret_file_path</span>
            <span class="c1"># Get spatial discretization file absolute path</span>
            <span class="n">discret_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">discret_file_path</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">discret_file_path</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing spatial discretization file&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The spatial discretization file specified under &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;the keyword - </span><span class="si">{}</span><span class="s1"> - could&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;not be found:&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span>
                         <span class="n">discret_file_path</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="n">format_exts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.npy&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">discret_file_path</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> \
            <span class="ow">in</span> <span class="n">format_exts</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span>
                <span class="n">discret_file_path</span><span class="p">))[</span><span class="mi">0</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">valid_exts</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid spatial discretization file extension&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The spatial discretization file specified under &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the keyword - </span><span class="si">{}</span><span class="s1"> - does&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;not have a valid extension.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span>
                <span class="n">discret_file_path</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">valid_exts</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid spatial discretization file extension&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The spatial discretization file specified under &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the keyword - </span><span class="si">{}</span><span class="s1"> - does&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;not have a valid extension.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">discret_file_path</span><span class="p">)</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_rve_dimensions"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_rve_dimensions.html#cratepy.ioput.readprocedures.read_rve_dimensions">[docs]</a><span class="k">def</span> <span class="nf">read_rve_dimensions</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read RVE dimensions (size length along each spatial dimension).</span>

<span class="sd">    The specification of the data associated with the RVE dimensions has the</span>
<span class="sd">    following input data file syntax:</span>

<span class="sd">    *2D Problem:*</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       RVE_Dimensions</span>
<span class="sd">       &lt; dim1_size &gt; &lt; dim2_size &gt;</span>

<span class="sd">    where `dimX_size` is the size length along dimension X.</span>

<span class="sd">    ----</span>

<span class="sd">    *3D Problem:*</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       RVE_Dimensions</span>
<span class="sd">       &lt; dim1_size &gt; &lt; dim2_size &gt; &lt; dim3_size &gt;</span>

<span class="sd">    where `dimX_size` is the size length along dimension X.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword: str</span>
<span class="sd">        Keyword.</span>
<span class="sd">    n_dim : int</span>
<span class="sd">        Problem number of spatial dimensions.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rve_dims : list[float]</span>
<span class="sd">        RVE size in each dimension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_line_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_dim</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dim</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checknumber</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="n">rve_dims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dim</span><span class="p">):</span>
        <span class="n">rve_dims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">rve_dims</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_self_consistent_scheme"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_self_consistent_scheme.html#cratepy.ioput.readprocedures.read_self_consistent_scheme">[docs]</a><span class="k">def</span> <span class="nf">read_self_consistent_scheme</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">strain_formulation</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read self-consistent scheme and associated parameters.</span>

<span class="sd">    The specification of the data associated with the self-consistent scheme</span>
<span class="sd">    has the following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       Self_Consistent_Scheme &lt; method &gt; [ &lt; n_parameters &gt; ]</span>
<span class="sd">       [ &lt; parameter_1_name &gt; &lt; value &gt; ]</span>
<span class="sd">       [ &lt; parameter_2_name &gt; &lt; value &gt; ]</span>
<span class="sd">       ...</span>

<span class="sd">    where `method` (str) is the self-consistent scheme strategy to update the</span>
<span class="sd">    reference material properties, `n_parameters` (int) is the number of</span>
<span class="sd">    self-consistent scheme parameters, and `parameter_X_name` (str) is the</span>
<span class="sd">    self-consistent scheme parameter name.</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword: str</span>
<span class="sd">        Keyword.</span>
<span class="sd">    strain_formulation: {&#39;infinitesimal&#39;, &#39;finite&#39;}</span>
<span class="sd">        Problem strain formulation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    self_consistent_scheme : {&#39;none&#39;, &#39;regression&#39;}</span>
<span class="sd">        Self-consistent scheme to update the elastic reference material</span>
<span class="sd">        properties.</span>
<span class="sd">    scs_parameters : {dict, None}</span>
<span class="sd">        Self-consistent scheme parameters (key, str; item, {int, float, bool}).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get display features</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">setdisplayfeatures</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Read keyword line</span>
    <span class="n">keyword_line_number</span> <span class="o">=</span> <span class="n">searchkeywordline</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Get available self-consistent schemes</span>
    <span class="n">available_scs</span> <span class="o">=</span> \
        <span class="n">ElasticReferenceMaterial</span><span class="o">.</span><span class="n">get_available_scs</span><span class="p">(</span><span class="n">strain_formulation</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">available_scs</span><span class="p">:</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined &#39;</span> \
            <span class="o">+</span> <span class="s1">&#39;in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Unknown self-consistent scheme.&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">self_consistent_scheme</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Read self-consistent scheme parameters</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in the &#39;</span>\
                <span class="o">+</span> <span class="s1">&#39;input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid number of self-consistent scheme &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;parameters.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Get number of self-consistent parameters</span>
            <span class="n">n_parameters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="c1"># Initialize self-consistent scheme parameters</span>
            <span class="n">scs_parameters</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># Loop over self-consistent scheme parameters</span>
            <span class="n">line_number</span> <span class="o">=</span> <span class="n">keyword_line_number</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_parameters</span><span class="p">):</span>
                <span class="c1"># Get self-consistent scheme parameter specification line</span>
                <span class="n">parameter_line</span> <span class="o">=</span> \
                    <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">line_number</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="c1"># Get self-consistent scheme parameter</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">parameter_line</span><span class="p">:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing self-consistent scheme parameter&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span>\
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Missing specification of self-consistent &#39;</span>\
                        <span class="o">+</span> <span class="s1">&#39;scheme parameter.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter_line</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid self-consistent scheme parameter&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span>\
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid specification of self-consistent &#39;</span>\
                        <span class="o">+</span> <span class="s1">&#39;scheme parameter.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkvalidname</span><span class="p">(</span><span class="n">parameter_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid self-consistent scheme parameter&#39;</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span>\
                        <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Invalid self-consistent scheme parameter &#39;</span>\
                        <span class="o">+</span> <span class="s1">&#39;name.&#39;</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">scs_parameters</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">parameter_line</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> \
                        <span class="n">get_formatted_parameter</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">parameter_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                                <span class="n">parameter_line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scs_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;E_init&#39;</span><span class="p">:</span> <span class="s1">&#39;init_eff_tangent&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;v_init&#39;</span><span class="p">:</span> <span class="s1">&#39;init_eff_tangent&#39;</span><span class="p">}</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check if all reference material isotropic elastic properties were</span>
    <span class="c1"># prescribed</span>
    <span class="k">if</span> <span class="n">scs_parameters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">param_names</span> <span class="o">=</span> <span class="n">scs_parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;E_init&#39;</span> <span class="ow">in</span> <span class="n">param_names</span> <span class="ow">and</span> <span class="s1">&#39;v_init&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param_names</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;E_init&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param_names</span> <span class="ow">and</span> <span class="s1">&#39;v_init&#39;</span> <span class="ow">in</span> <span class="n">param_names</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Missing reference material elastic property&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly &#39;</span>\
                <span class="o">+</span> <span class="s1">&#39;defined in the input data file.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">+</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;Both elastic properties of the elastic &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;reference material must be prescribed.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">self_consistent_scheme</span><span class="p">,</span> <span class="n">scs_parameters</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="read_vtk_options"><a class="viewcode-back" href="../../../_autosummary/cratepy.ioput.readprocedures.read_vtk_options.html#cratepy.ioput.readprocedures.read_vtk_options">[docs]</a><span class="k">def</span> <span class="nf">read_vtk_options</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">keyword_line_number</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read VTK output options.</span>

<span class="sd">    The specification of the data associated with the VTK output options has</span>
<span class="sd">    the following input data file syntax:</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">       VTK_Output [ &lt; option_1 &gt; &lt; option_2 &gt; ... ]</span>

<span class="sd">    where `option_X` is option of the VTK output (e.g., ascii, every &lt; int &gt;,</span>
<span class="sd">    all_variables).</span>

<span class="sd">    ----</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : file</span>
<span class="sd">        Data file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Data file path.</span>
<span class="sd">    keyword: str</span>
<span class="sd">        Keyword.</span>
<span class="sd">    keyword_line_number: int</span>
<span class="sd">        Keyword line number.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtk_format : {&#39;ascii&#39;, &#39;binary&#39;}</span>
<span class="sd">        VTK format.</span>
<span class="sd">    vtk_inc_div : int</span>
<span class="sd">        VTK output increment divider.</span>
<span class="sd">    vtk_vars : {&#39;all&#39;, &#39;common&#39;}</span>
<span class="sd">        VTK output constitutive state variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">linecache</span><span class="o">.</span><span class="n">getline</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keyword_line_number</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checknumber</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;binary&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;This VTK format has not been implemented yet.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vtk_format</span> <span class="o">=</span> <span class="s1">&#39;ascii&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;every&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">checkposint</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;every&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;Invalid keyword specification&#39;</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;The keyword - </span><span class="si">{}</span><span class="s1"> - is not properly defined in &#39;</span> \
                <span class="o">+</span> <span class="s1">&#39;the input data file.&#39;</span>
            <span class="n">info</span><span class="o">.</span><span class="n">displayinfo</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">keyword</span><span class="p">)</span>
        <span class="n">vtk_inc_div</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;every&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vtk_inc_div</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="s1">&#39;common_variables&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="n">vtk_vars</span> <span class="o">=</span> <span class="s1">&#39;common&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vtk_vars</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">vtk_format</span><span class="p">,</span> <span class="n">vtk_inc_div</span><span class="p">,</span> <span class="n">vtk_vars</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Bernardo Ferreira.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>